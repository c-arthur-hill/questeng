{% extends "base.html" %}

{% block homelink %}active{% endblock %}
{% block title %}TalkWeird{% endblock %}
{% block header %}TalkWeird{% endblock %}
{% block content %}
<table>
    {% if not user.is_authenticated and show_save_message %}
    <thead>
        <tr>
            <th class="tr-background-2"><a href="{% if conversation_id %}{% url 'register_id' conversation_id %}{% else %}{% url 'register' %}{% endif %}">Register</a> or <a href="{% if conversation_id %}{% url 'login_id' conversation_id %}{% else %}{% url 'login' %}{% endif %}">Login</a> to save your answers</th>
        </tr>
    </thead>
    {% endif %}
    <tbody>
	{% for message in messages %}
	<tr>
        {% if message.question %}
            <td class="tr-background-2">{{ message.question.text }}</td>
        {% else %}
            <td class="tr-background-1">{{ message.answer.text }}</td>
        {% endif %}
	</tr>
	{% endfor %}
    </tbody>
</table>
<form action="{% if conversation_id %}{% url 'conversation_id' conversation_id %}{% else %}{% url 'conversation' %}{% endif %}" method="POST">
    <div class="tr-background-1 background-border">
	{% csrf_token %}
	{{ form.last_question }}
    {% for answer_input in form.answer|slice:"1:4" %}
        {{ answer_input }}
    {% endfor %}
    {{ form.answer|first }}
    {{ form.text }}
    </div>
    <div class="nav">
    <br>
	<input class="submit-button" type="submit" value="ANSWER">
    {# and has higher precedence than or #}
    {% if not empty_messages %}
    <a href="{% if conversation_id %}{% url 'question_id' conversation_id next_question_id %}{% else %}{% url 'question' next_question_id %}{% endif %}">Different Question</a>
    <span> | </span>
    {% endif %}
    <a href="{% if conversation_id %}{% url 'question_id' conversation_id next_question_id %}{% else %}{% url 'question' next_question_id %}{% endif %}">Random Topic</a>
    </div>
</form>
<br>
{% for topic in topics %}
    <h3>{{ topic.description }}</h3>
    {% for icebreaker in topic.top_questions %}
    <a href="{% if conversation_id %}{% url 'question_id' conversation_id icebreaker.id %}{% else %}{% url 'question' icebreaker.id %}{% endif %}">{{ icebreaker.text }}</a><br>
    {% endfor %}
{% endfor %}
{% endblock %}
